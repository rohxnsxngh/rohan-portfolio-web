---
import RobotModelViewer from "../components/RobotModelViewer.astro";
---

<div
  class="hero-section relative min-h-screen bg-secondary flex items-center justify-center overflow-hidden"
  id="main-content"
>
  <!-- FULL PAGE ROBOT BACKGROUND -->
  <div class="robot-background-container absolute inset-0 z-0" id="robot-container">
    <div class="robot-frame-fullscreen w-full h-full">
      <div class="w-full h-full robot-viewer" id="robot-viewer">
        <RobotModelViewer />
      </div>
    </div>

    <!-- Dark overlay to dim robot heavily by default (almost invisible) -->
    <div class="robot-overlay absolute inset-0 bg-black/95 pointer-events-none transition-all duration-500" id="robot-dim"></div>
  </div>

  <!-- Tech grid overlay for texture -->
  <div class="absolute inset-0 tech-grid opacity-10 z-[5] pointer-events-none"></div>

  <!-- Main content - layered on top with semi-transparent effect -->
  <div class="hero-content relative z-10 w-full px-4 sm:px-6 lg:px-8 pointer-events-none transition-opacity duration-300" id="hero-content">
    <div class="max-w-7xl mx-auto">

      <!-- Small intro label -->
      <div class="label-intro mb-6 sm:mb-8">
        <span class="text-primary/50 font-mono text-xs sm:text-sm tracking-[0.3em] uppercase">
          Engineer • Builder • Creator
        </span>
      </div>

      <!-- MASSIVE name display -->
      <div class="name-display mb-6 sm:mb-10">
        <h1 class="hero-name font-mono font-black tracking-tighter leading-none select-none">
          <div class="name-line">
            <span class="char char-1">R</span><span class="char char-2">O</span><span class="char char-3">H</span><span class="char char-4">A</span><span class="char char-5">N</span>
          </div>
          <div class="name-line">
            <span class="char char-6">S</span><span class="char char-7">I</span><span class="char char-8">N</span><span class="char char-9">G</span><span class="char char-10">H</span>
          </div>
        </h1>
      </div>

      <!-- Bold statement -->
      <div class="statement mb-8 sm:mb-12 max-w-4xl">
        <p class="statement-text text-primary/60 font-mono tracking-wide leading-relaxed">
          Keep <span class="highlight">Building</span> 
        </p>
      </div>

      <!-- CTA Section -->
      <div class="cta-section flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center pointer-events-auto">
        <a
          href="/project"
          class="cta-primary group relative inline-flex items-center justify-center px-10 py-5 bg-primary text-secondary font-mono text-sm sm:text-base tracking-wider font-bold overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-primary/40"
        >
          <span class="relative z-10">VIEW MY WORK</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 ml-3 group-hover:translate-x-2 transition-transform relative z-10"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2.5"
              d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
          </svg>
          <div class="cta-shine"></div>
        </a>

        <a
          href="/about"
          class="cta-secondary group inline-flex items-center text-primary/70 hover:text-primary font-mono text-sm sm:text-base tracking-wider transition-all duration-300"
        >
          Learn more about me
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4 ml-2 group-hover:translate-x-1 transition-transform"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Scroll indicator -->
  <div class="scroll-indicator-minimal absolute bottom-8 left-1/2 -translate-x-1/2 hidden lg:block z-20">
    <div class="w-6 h-10 border-2 border-primary/30 rounded-full flex items-start justify-center p-2">
      <div class="w-1 h-2 bg-primary/50 rounded-full animate-scroll-dot"></div>
    </div>
  </div>
</div>

<style>
  /* ===== THEME: BOLD TECH MINIMALISM ===== */

  /* Tech grid background */
  .tech-grid {
    background-image:
      linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
    background-size: 100px 100px;
    animation: gridPan 60s linear infinite;
  }

  @keyframes gridPan {
    0% { background-position: 0 0; }
    100% { background-position: 100px 100px; }
  }

  /* Gradient overlay for depth */
  .gradient-overlay {
    background: radial-gradient(circle at 30% 50%, rgba(255, 255, 255, 0.03), transparent 50%);
  }

  /* ===== MASSIVE TYPOGRAPHY ===== */
  .hero-name {
    font-size: clamp(4rem, 18vw, 18rem);
    line-height: 0.85;
    letter-spacing: -0.08em;
    color: #ffffff;
    text-transform: uppercase;
  }

  .hero-name .name-line {
    display: block;
    position: relative;
  }

  /* Individual character animations */
  .hero-name .char {
    display: inline-block;
    opacity: 0;
    transform: translateY(100px) scale(0.8);
    animation: charReveal 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    text-shadow:
      0 0 40px rgba(255, 255, 255, 0.1),
      0 10px 30px rgba(0, 0, 0, 0.5);
  }

  /* Staggered animation delays */
  .char-1 { animation-delay: 0.05s; }
  .char-2 { animation-delay: 0.10s; }
  .char-3 { animation-delay: 0.15s; }
  .char-4 { animation-delay: 0.20s; }
  .char-5 { animation-delay: 0.25s; }
  .char-6 { animation-delay: 0.30s; }
  .char-7 { animation-delay: 0.35s; }
  .char-8 { animation-delay: 0.40s; }
  .char-9 { animation-delay: 0.45s; }
  .char-10 { animation-delay: 0.50s; }

  @keyframes charReveal {
    0% {
      opacity: 0;
      transform: translateY(100px) scale(0.8);
    }
    60% {
      transform: translateY(-10px) scale(1.02);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* Label intro animation */
  .label-intro {
    opacity: 0;
    animation: fadeInDown 0.8s ease-out forwards;
  }

  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Statement text */
  .statement {
    opacity: 0;
    animation: fadeInUp 1s ease-out forwards;
    animation-delay: 0.7s;
  }

  .statement-text {
    font-size: clamp(1rem, 2.5vw, 1.5rem);
    line-height: 1.6;
  }

  .highlight {
    color: #ffffff;
    font-weight: 700;
    position: relative;
  }

  .highlight::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.5), transparent);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* CTA Section */
  .cta-section {
    opacity: 0;
    animation: fadeInUp 1s ease-out forwards;
    animation-delay: 0.9s;
  }

  /* Primary CTA Button */
  .cta-primary {
    position: relative;
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
  }

  .cta-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.7s;
  }

  .cta-primary:hover .cta-shine {
    left: 100%;
  }

  /* Secondary CTA */
  .cta-secondary {
    text-decoration: underline;
    text-decoration-color: rgba(255, 255, 255, 0.2);
    text-underline-offset: 6px;
    text-decoration-thickness: 1px;
  }

  .cta-secondary:hover {
    text-decoration-color: rgba(255, 255, 255, 0.6);
  }

  /* Info bar */
  .info-bar {
    opacity: 0;
    animation: fadeIn 1s ease-out forwards;
    animation-delay: 1.2s;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  .info-item {
    opacity: 0;
    animation: fadeInUp 0.6s ease-out forwards;
  }

  .info-item:nth-child(1) { animation-delay: 1.3s; }
  .info-item:nth-child(2) { animation-delay: 1.4s; }
  .info-item:nth-child(3) { animation-delay: 1.5s; }

  /* ===== ROBOT AS FULL BACKGROUND ===== */

  .robot-background-container {
    opacity: 1;
  }

  .robot-frame-fullscreen {
    position: absolute;
    inset: 0;
  }

  /* Robot overlay - dims the robot heavily, lightens on hover */
  .robot-overlay {
    z-index: 1;
    transition: background 0.6s ease-out;
  }

  /* Hero content with slower fade transitions for psychology */
  .hero-content {
    opacity: 1;
    transition: opacity 0.5s ease-out;
  }

  /* Typography with enhanced text shadow for better readability */
  .hero-name {
    text-shadow:
      0 3px 25px rgba(0, 0, 0, 0.9),
      0 6px 45px rgba(0, 0, 0, 0.7),
      0 0 80px rgba(0, 0, 0, 0.5);
  }

  .statement-text,
  .label-intro span,
  .info-bar {
    text-shadow:
      0 2px 15px rgba(0, 0, 0, 0.95),
      0 4px 25px rgba(0, 0, 0, 0.8);
  }

  /* Mouse interaction states - slower transitions */
  .hero-section.mouse-active .hero-content {
    opacity: 0.25;
    transition: opacity 0.6s ease-out;
  }

  .hero-section.mouse-active .robot-overlay {
    background: rgba(0, 0, 0, 0.2) !important;
  }

  /* When mouse becomes inactive, fade back slowly to let user admire */
  .hero-section:not(.mouse-active) .hero-content {
    transition: opacity 2s ease-in-out;
  }

  .hero-section:not(.mouse-active) .robot-overlay {
    transition: background 2.5s ease-in-out;
  }

  /* Scroll indicator */
  .scroll-indicator-minimal {
    opacity: 0;
    animation: fadeIn 1.5s ease-out forwards;
    animation-delay: 2s;
  }

  @keyframes scroll-dot {
    0%, 100% {
      transform: translateY(0);
      opacity: 1;
    }
    50% {
      transform: translateY(12px);
      opacity: 0.5;
    }
  }

  .animate-scroll-dot {
    animation: scroll-dot 2s ease-in-out infinite;
  }

  /* ===== RESPONSIVE DESIGN ===== */

  @media (max-width: 1024px) {
    .hero-name {
      font-size: clamp(3.5rem, 15vw, 14rem);
      letter-spacing: -0.06em;
    }

    .robot-accent {
      width: 14rem;
      height: 14rem;
    }
  }

  @media (max-width: 768px) {
    .hero-name {
      font-size: clamp(3rem, 18vw, 10rem);
      letter-spacing: -0.04em;
    }

    .statement-text {
      font-size: clamp(0.9rem, 3vw, 1.25rem);
    }

    .info-bar {
      margin-top: 3rem;
    }

    /* Less aggressive hover effect on tablet */
    .hero-section.mouse-active .hero-content {
      opacity: 0.5;
    }
  }

  @media (max-width: 640px) {
    .hero-name {
      font-size: clamp(2.5rem, 20vw, 8rem);
      letter-spacing: -0.02em;
    }

    .label-intro span {
      font-size: 0.65rem;
      letter-spacing: 0.2em;
    }

    .cta-primary {
      width: 100%;
    }

    /* Slightly more visible robot on mobile - but still dim */
    .robot-overlay {
      background: rgba(0, 0, 0, 0.85) !important;
    }

    /* Disable hover effect on mobile */
    .hero-section.mouse-active .hero-content {
      opacity: 1;
    }

    .hero-section.mouse-active .robot-overlay {
      background: rgba(0, 0, 0, 0.85) !important;
    }
  }

  /* Prevent layout shift */
  .hero-section {
    min-height: 100vh;
    min-height: 100dvh; /* Dynamic viewport height for mobile */
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const heroSection = document.getElementById("main-content");
    const robotContainer = document.getElementById("robot-container");

    let mouseActive = false;
    let mouseTimeout: number | null = null;

    // ===== DUAL HOVER ANIMATION =====
    // Track mouse movement and dispatch to THREE.js scene
    if (heroSection && robotContainer) {
      heroSection.addEventListener("mousemove", (e) => {
        const rect = heroSection.getBoundingClientRect();

        // Calculate mouse position (0 to 1 normalized coordinates)
        const mouseX = (e.clientX - rect.left) / rect.width;
        const mouseY = (e.clientY - rect.top) / rect.height;

        // Activate hover state (fade typography, lighten robot overlay)
        if (!mouseActive) {
          heroSection.classList.add('mouse-active');
          mouseActive = true;
        }

        // Clear existing timeout
        if (mouseTimeout) {
          clearTimeout(mouseTimeout);
        }

        // Dispatch mouse position to THREE.js robot viewer
        // This will be caught by the RobotModelViewer component to add dynamic lighting
        document.dispatchEvent(
          new CustomEvent("robotMouseMove", {
            detail: {
              x: mouseX,
              y: mouseY,
              clientX: e.clientX,
              clientY: e.clientY
            },
          })
        );

        // Reset to inactive state after mouse stops moving (longer delay for admiration)
        mouseTimeout = window.setTimeout(() => {
          heroSection.classList.remove('mouse-active');
          mouseActive = false;

          // Notify robot viewer that mouse is inactive
          document.dispatchEvent(
            new CustomEvent("robotMouseInactive", {
              detail: { inactive: true },
            })
          );
        }, 800); // Increased from 150ms to 800ms for user to admire robot
      });

      // Remove active state when mouse leaves
      heroSection.addEventListener("mouseleave", () => {
        heroSection.classList.remove('mouse-active');
        mouseActive = false;

        if (mouseTimeout) {
          clearTimeout(mouseTimeout);
          mouseTimeout = null;
        }

        // Notify robot viewer that mouse left
        document.dispatchEvent(
          new CustomEvent("robotMouseLeave", {
            detail: { left: true },
          })
        );
      });

      // Reactivate on mouse enter
      heroSection.addEventListener("mouseenter", () => {
        // Notify robot viewer that mouse entered
        document.dispatchEvent(
          new CustomEvent("robotMouseEnter", {
            detail: { entered: true },
          })
        );
      });
    }

    // ===== SMOOTH SCROLL FOR SCROLL INDICATOR =====
    const scrollIndicator = document.querySelector(".scroll-indicator-minimal");
    if (scrollIndicator) {
      scrollIndicator.addEventListener("click", () => {
        window.scrollTo({
          top: window.innerHeight,
          behavior: "smooth",
        });
      });
    }

    // ===== PARALLAX EFFECT ON SCROLL =====
    let ticking = false;
    window.addEventListener("scroll", () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          const scrolled = window.pageYOffset;
          const heroContent = document.querySelector(".hero-content");

          if (heroContent && scrolled < window.innerHeight) {
            const opacity = Math.max(0, 1 - scrolled / (window.innerHeight * 0.7));
            const translateY = scrolled * 0.3;
            (heroContent as HTMLElement).style.opacity = opacity.toString();
            (heroContent as HTMLElement).style.transform = `translateY(${translateY}px)`;
          }

          ticking = false;
        });
        ticking = true;
      }
    });
  });
</script>
